<style>
  :root {
    color-scheme: light;
    font-family: "Segoe UI", Arial, sans-serif;
    font-size: 12px;
    line-height: 1.5;
  }

  .report {
    width: 100%;
    max-width: 860px;
    margin: 0 auto;
    color: #1f2933;
  }

  .header {
    text-align: center;
    margin-bottom: 24px;
  }

  .header h1 {
    font-size: 20px;
    margin: 0;
    color: #20364b;
  }

  .header p {
    margin: 4px 0;
    color: #52606d;
    font-size: 12px;
  }

  .summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 10px;
    margin-bottom: 28px;
  }

  .summary-card {
    border: 1px solid #d9e2ec;
    border-radius: 8px;
    padding: 10px;
    background: #f7f9fc;
  }

  .summary-card .label {
    display: block;
    font-size: 11px;
    color: #52606d;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 4px;
  }

  .summary-card .value {
    display: block;
    font-size: 16px;
    font-weight: 600;
    color: #20364b;
  }

  .summary-card .value.negative {
    color: #b42318;
  }

  .summary-card .caption {
    display: block;
    font-size: 10px;
    color: #7b8794;
    margin-top: 4px;
  }

  section {
    margin-bottom: 30px;
  }

  section h2 {
    font-size: 16px;
    margin-bottom: 12px;
    color: #20364b;
  }

  .currency-heading {
    display: flex;
    align-items: baseline;
    gap: 8px;
  }

  .currency-tag {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 999px;
    background: #e4ebf5;
    color: #334e68;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.04em;
  }

  .section-subtitle {
    margin: -6px 0 10px;
    font-size: 11px;
    color: #7b8794;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 8px;
  }

  th,
  td {
    border: 1px solid #d9e2ec;
    padding: 6px 9px;
    text-align: left;
    font-size: 12px;
  }

  th {
    background: #e4ebf5;
    color: #334e68;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 10px;
  }

  tr:nth-child(even) td {
    background: #f7f9fc;
  }

  .number-cell {
    text-align: right;
    font-feature-settings: "tnum";
  }

  .negative {
    color: #b42318;
    font-weight: 600;
  }

  .totals {
    font-size: 12px;
    color: #334e68;
    margin-bottom: 6px;
  }

  .category-description {
    display: block;
    font-size: 10px;
    color: #7b8794;
    margin-top: 3px;
  }

  .footnote {
    font-size: 10px;
    color: #7b8794;
    text-align: center;
  }
</style>

<div class="report">
  <header class="header">
    <h1>{{t "financial_report.title"}}</h1>
    <p>{{t "financial_report.period_label"}} {{period.month}}/{{period.year}}</p>
    {{#if summary}}
      <p>{{t "financial_report.summary_note"}}</p>
    {{/if}}
  </header>

  {{#if summary}}
    <section>
      <h2>{{t "financial_report.summary.title"}}</h2>
      {{#each summary}}
        <div class="currency-heading">
          <span class="currency-tag">{{symbol}}</span>
        </div>
        <div class="summary-grid">
          {{#if summary}}
            <div class="summary-card">
              <span class="label">{{t "financial_report.summary.net_revenue"}} ({{symbol}})</span>
              <span class="value {{#if (isNegative summary.revenue)}}negative{{/if}}">
                {{formatCurrency summary.revenue symbol}}
              </span>
              <span class="caption">{{t "financial_report.summary.caption.net_revenue"}}</span>
            </div>
            <div class="summary-card">
              <span class="label">{{t "financial_report.summary.operating_expenses"}} ({{symbol}})</span>
              <span class="value {{#if (isNegative summary.operatingExpenses)}}negative{{/if}}">
                {{formatCurrency summary.operatingExpenses symbol}}
              </span>
              <span class="caption">{{t "financial_report.summary.caption.operating_expenses"}}</span>
            </div>
            <div class="summary-card">
              <span class="label">{{t "financial_report.summary.operating_income"}} ({{symbol}})</span>
              <span class="value {{#if (isNegative summary.operatingIncome)}}negative{{/if}}">
                {{formatCurrency summary.operatingIncome symbol}}
              </span>
              <span class="caption">{{t "financial_report.summary.caption.operating_income"}}</span>
            </div>
            <div class="summary-card">
              <span class="label">{{t "financial_report.summary.net_income"}} ({{symbol}})</span>
              <span class="value {{#if (isNegative summary.netIncome)}}negative{{/if}}">
                {{formatCurrency summary.netIncome symbol}}
              </span>
              <span class="caption">{{t "financial_report.summary.caption.net_income"}}</span>
            </div>
          {{/if}}
        </div>
      {{/each}}
    </section>
  {{/if}}

  {{#if breakdown}}
    <section>
      <h2>{{t "financial_report.breakdown.title"}}</h2>
      {{#each breakdown}}
        <div class="currency-heading">
          <span class="currency-tag">{{symbol}}</span>
        </div>
        <table>
          <thead>
            <tr>
              <th>{{t "financial_report.breakdown.headers.category"}}</th>
              <th>{{t "financial_report.breakdown.headers.income"}}</th>
              <th>{{t "financial_report.breakdown.headers.expenses"}}</th>
              <th>{{t "financial_report.breakdown.headers.net"}}</th>
            </tr>
          </thead>
          <tbody>
            {{#each breakdown}}
              <tr>
                <td>
                  {{translateCategory category}}
                  {{#if (categoryDescription category)}}
                    <span class="category-description">
                      {{categoryDescription category}}
                    </span>
                  {{/if}}
                </td>
                <td class="number-cell {{#if (isNegative income)}}negative{{/if}}">
                  {{formatCurrency income ../symbol}}
                </td>
                <td class="number-cell {{#if (isNegative expenses)}}negative{{/if}}">
                  {{formatCurrency expenses ../symbol}}
                </td>
                <td class="number-cell {{#if (isNegative net)}}negative{{/if}}">
                  {{formatCurrency net ../symbol}}
                </td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      {{/each}}
    </section>
  {{/if}}

  {{#with cashFlowSnapshot.availabilityAccounts}}
    {{#if totals}}
      {{#each totals}}
        <section>
          <div class="currency-heading">
            <h2>{{t "financial_report.cash_flow.title"}}</h2>
            <span class="currency-tag">{{symbol}}</span>
          </div>
          <p class="totals">
            {{t "financial_report.cash_flow.totals.income"}}
            {{formatCurrency income symbol}}
            | {{t "financial_report.cash_flow.totals.expenses"}}
            {{formatCurrency expenses symbol}}
            | {{t "financial_report.cash_flow.totals.total"}}
            {{formatCurrency total symbol}}
          </p>
          {{#if ../accounts}}
            <table>
              <thead>
                <tr>
                  <th>{{t "financial_report.cash_flow.headers.account"}}</th>
                  <th>{{t "financial_report.cash_flow.headers.income"}}</th>
                  <th>{{t "financial_report.cash_flow.headers.expenses"}}</th>
                  <th>{{t "financial_report.cash_flow.headers.period_balance"}}</th>
                </tr>
              </thead>
              <tbody>
                {{#each ../accounts}}
                  {{#ifEquals availabilityAccount.symbol ../symbol}}
                    <tr>
                      <td>{{availabilityAccount.accountName}}</td>
                      <td class="number-cell {{#if (isNegative totalInput)}}negative{{/if}}">
                        {{formatCurrency totalInput availabilityAccount.symbol}}
                      </td>
                      <td class="number-cell {{#if (isNegative totalOutput)}}negative{{/if}}">
                        {{formatCurrency totalOutput availabilityAccount.symbol}}
                      </td>
                      <td class="number-cell {{#if (isNegative (subtract totalInput totalOutput))}}negative{{/if}}">
                        {{formatCurrency (subtract totalInput totalOutput) availabilityAccount.symbol}}
                      </td>
                    </tr>
                  {{/ifEquals}}
                {{/each}}
              </tbody>
            </table>
          {{/if}}
        </section>
      {{/each}}
    {{/if}}
  {{/with}}

  {{#with cashFlowSnapshot.costCenters}}
    {{#if totals}}
      {{#each totals}}
        <section>
          <div class="currency-heading">
            <h2>{{t "financial_report.cost_centers.title"}}</h2>
            <span class="currency-tag">{{symbol}}</span>
          </div>
          <p class="totals">{{t "financial_report.cost_centers.total_label"}} {{formatCurrency total symbol}}</p>
          <table>
            <thead>
              <tr>
                <th>{{t "financial_report.cost_centers.headers.cost_center"}}</th>
                <th>{{t "financial_report.cost_centers.headers.total_applied"}}</th>
                <th>{{t "financial_report.cost_centers.headers.last_move"}}</th>
              </tr>
            </thead>
            <tbody>
              {{#each ../costCenters}}
                {{#ifEquals symbol ../symbol}}
                  <tr>
                    <td>{{costCenter.costCenterName}}</td>
                    <td class="number-cell {{#if (isNegative total)}}negative{{/if}}">
                      {{formatCurrency total symbol}}
                    </td>
                    <td>{{formatDate lastMove}}</td>
                  </tr>
                {{/ifEquals}}
              {{/each}}
            </tbody>
          </table>
        </section>
      {{/each}}
    {{/if}}
  {{/with}}

  <p class="footnote">
    {{t "financial_report.footnote"}}
  </p>
</div>
